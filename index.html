<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced Liveness Detection</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1 class="title">Liveness Detection</h1>

    <div class="form">
      <!-- Text Inputs -->
      <label for="partnerTransactionId">Partner Transaction ID:</label>
      <input type="text" id="partnerTransactionId" placeholder="Enter Partner Transaction ID">

      <label for="localeConfigs">Locale Configs (JSON):</label>
      <textarea id="localeConfigs" placeholder='{"language": "en", "region": "US"}'></textarea>

      <label for="themeConfigs">Theme Configs (JSON):</label>
      <textarea id="themeConfigs" placeholder='{"primaryColor": "#3498db", "secondaryColor": "#2ecc71"}'></textarea>

      <!-- Dropdown -->
      <label for="languageToggle">Language:</label>
      <select id="languageToggle">
        <option value="EN">English</option>
        <option value="ID">Bahasa</option>
      </select>

<!-- Checkboxes -->
<div class="checkbox-container">
  <div class="checkbox-group">
    <input type="checkbox" id="skipTutorial">
    <label for="skipTutorial">Skip Tutorial Screen</label>
  </div>
  <div class="checkbox-group">
    <input type="checkbox" id="skipSelfieReview">
    <label for="skipSelfieReview">Skip Selfie Review Screen</label>
  </div>
</div>

      <!-- Additional Fields -->
      <label for="cameraFrameShape">Camera Frame Shape:</label>
      <select id="cameraFrameShape">
        <option value="oval">Oval</option>
        <option value="circle">Circle</option>
        <option value="square">Square</option>
        <option value="rectangle">Rectangle</option>
      </select>

      <label for="maxRetryAttempts">Max Retry Attempts:</label>
      <input type="number" id="maxRetryAttempts" placeholder="Enter Max Retry Attempts">

      <label for="detectionTimeout">Detection Timeout (in seconds):</label>
      <input type="number" id="detectionTimeout" placeholder="Enter Detection Timeout">
    </div>

    <!-- Button -->
    <button id="startLiveness" class="button">Start Liveness</button>

    <!-- Loader -->
    <div id="loader" class="loader"></div>

    <!-- Response Containers -->
    <div id="vida-container" class="vida-container">Click the button to start liveness detection.</div>
    <div id="api-response" class="api-response"></div>
  </div>

  <script type="module">
    import { VidaSDK } from 'https://web-sdk.vida.id/0.0.6/qa/vida-sdk-ui.js';

    document.getElementById('startLiveness').addEventListener('click', () => {
      const loader = document.getElementById('loader');
      loader.style.display = 'block';

      const responseDiv = document.getElementById('api-response');
      responseDiv.style.display = 'none';
      responseDiv.textContent = '';

      setTimeout(() => {
        loader.style.display = 'none'; // Simulating SDK load time
      }, 2000);

      // Get input values
      const partnerTransactionId = document.getElementById('partnerTransactionId').value;
      const locale = document.getElementById('languageToggle').value;
      const skipTutorialScreen = document.getElementById('skipTutorial').checked;
      const skipSelfieReviewScreen = document.getElementById('skipSelfieReview').checked;
      const cameraFrameShape = document.getElementById('cameraFrameShape').value;
      const maxRetryAttempts = parseInt(document.getElementById('maxRetryAttempts').value || 3);
      const detectionTimeout = parseInt(document.getElementById('detectionTimeout').value || 30000);
      const localeConfigs = document.getElementById('localeConfigs').value;
      const themeConfigs = document.getElementById('themeConfigs').value;

      console.log('detectionTimeout', detectionTimeout);

      try {
        // Parse JSON inputs
        const parsedLocaleConfigs = JSON.parse(localeConfigs || '{}');
        const parsedThemeConfigs = JSON.parse(themeConfigs || '{}');

        if (VidaSDK) {
          VidaSDK.init({
            token: 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJjU2w2LS1GWjE3MGJkZE1nU3NlMEhiTG10cWREYVI5aWdsNldRdkdhZVVrIn0.eyJleHAiOjE3MzI4MDU2MjQsImlhdCI6MTczMjc4NzYyNCwiYXV0aF90aW1lIjoxNzMyNzg3NjIzLCJqdGkiOiI5NDk1NzU2Zi05ZmFiLTQzOGYtYWQ0Yy1kOWVkMjgyZTQwOGIiLCJpc3MiOiJodHRwczovL3FhLXNzby5ucC52aWRhLmlkL2F1dGgvcmVhbG1zL3ZpZGEiLCJhdWQiOlsidmlkYS1pZGktbWFpbi1zZXJ2aWNlIiwidmlkYS1pZHZlcmlmeS1zZXJ2aWNlIl0sInN1YiI6ImFlZmY0MTYxLWQwY2ItNDQ5YS05YjY2LTQxOGExMzRjZjgyMyIsInR5cCI6IkJlYXJlciIsImF6cCI6InZpZGEtZmVhdHVyZXMtZGVtby13ZWIiLCJub25jZSI6IjljMzBhODQyLTkzYjYtNGQ3NS04ZjY1LTNlMmVkYWRjNTY3NCIsInNlc3Npb25fc3RhdGUiOiIyYjc2ZjYxYS1kZDYwLTQ5NTUtOGE5Yy0xNGQ3MzZmOWYzZTAiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cHM6Ly9xYS1hcHAubnAudmlkYS5pZCJdLCJyZXNvdXJjZV9hY2Nlc3MiOnsidmlkYS1pZGktbWFpbi1zZXJ2aWNlIjp7InJvbGVzIjpbImNoZWNrX2ltYWdlX2hhY2tuZXNzIiwid2ViX3VzZXJfbGl2ZW5lc3MiLCJzZXJ2aWNlX3VzZXJfd2ViX2VreWMiXX0sInZpZGEtaWR2ZXJpZnktc2VydmljZSI6eyJyb2xlcyI6WyJkZW1vZy12MiIsIm9jci1rdHAiLCJrdHAtZmFjZS1tYXRjaCJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJzaWQiOiIyYjc2ZjYxYS1kZDYwLTQ5NTUtOGE5Yy0xNGQ3MzZmOWYzZTAiLCJjbGllbnRJZCI6InZpZGEtZmVhdHVyZXMtZGVtby13ZWIiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6InNhZ2FyIGNoaWxsYWwiLCJwcm9kSWQiOiI5YmU4N2U3OC04MzIwLTRhODQtYjIyMS0wMjE4OGY1ZTQxNDYiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJzYWdhci5jaGlsbGFsQHZpZGEuaWQiLCJnaXZlbl9uYW1lIjoic2FnYXIiLCJmYW1pbHlfbmFtZSI6ImNoaWxsYWwiLCJlbWFpbCI6InNhZ2FyLmNoaWxsYWxAdmlkYS5pZCJ9.HD5yY4zWeL2eiZcWY6IIjOsQrJ_qpRC1YfcM_-4sTj2BEBKwfEpwJL0ubZwAgXCHNx-x1HNQJtkDvPUqLjacMVN3Aert34-7wxwLXLv9OmoMGFZwJGwa1YqksUOfbpmN5bdOnV7oMeykGTOmS2vjXo9EUTOcq0eiHjxsINFV_3i1Mc0AJ8hrwBoekd7v40KTX0myI29Ge8qK4ilqZfGQm34XsEYcw50LEl4NhkSE_gfDugxvRSEjTXkW9DXBJZvSBMmAWI9zY-KPtzm-HiXkBmpHuUDe-yb9al296LtaOeb0ACNnAM_MdipqtFAIjh6tagTVXaBGVdAgAW81pjubsw',
            signingKey: 'e67c72e265b6288d9652a14099b64dc0b2939cc3a47873656a729431946691a1', 
            locale,
            partnerTransactionId,
            localeConfigs: parsedLocaleConfigs,
            themeConfigs: parsedThemeConfigs,
            workflowConfigs: {
              liveness: {
                skipTutorialScreen,
                skipSelfieReviewScreen,
                cameraFrameShape,
                maxRetryAttempts,
                detectionTimeout,
              },
            },
            onComplete: (apiResponse) => {
              console.log('API Response:', apiResponse);
              responseDiv.style.display = 'block';
              responseDiv.textContent = `API Response: ${JSON.stringify(apiResponse, null, 2)}`;
            },
            onError: (apiResponse) => {
              console.error('API Response:', apiResponse);
              responseDiv.style.display = 'block';
              responseDiv.textContent = `Error Response: ${JSON.stringify(apiResponse, null, 2)}`;
            },
            containerId: 'vida-container',
          });
        } else {
          console.error('VidaSDK is not available.');
        }
      } catch (error) {
        console.error('Invalid JSON format:', error);
        alert('Please enter valid JSON in Locale Configs and Theme Configs.');
      }
    });
  </script>
</body>
</html>
